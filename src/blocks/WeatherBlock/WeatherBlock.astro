---
import type { WeatherBlockFragment } from '@lib/datocms/types';

export interface Props {
    block: WeatherBlockFragment
}

const { block } = Astro.props;
---

<script src="./WeatherBlock.client.ts"></script>

<section
  id="weather-block"
  data-default-city={block.defaultCity}
  data-forecast={block.forecast}
>
  <h2>{block.title}</h2>
  <p>{block.infoText}</p>

  <div id="weather-search">
    <input id="city-input" placeholder="Type in a city..." />
    <button id="search-button">Search</button>
    <button id="geolocation-button">Use my location</button>
      <!-- TODO add autocomplete list for searching places -->
  </div>

  <div id="weather-output">
    <p>No weather information yet</p>
  </div>
</section>

<style>
  #weather-block {
    border: 1px solid #ccc;
    padding: 1rem;
    border-radius: 8px;
  }
  #weather-search {
    margin-bottom: 1rem;
    display: flex;
    gap: 0.5em;
    flex-wrap: wrap;
  }
  #city-input {
    flex: 1;
    min-width: 10em;
    padding: 0.5em;
    &.input-error {
      border: 1px solid red;
    }
  }
  #search-button, #geolocation-button {
    padding: 0.5em 1em;
    cursor: pointer;
  }
  #weather-output {
    img {
      height: fit-content;
      width: 100%;
    }
    .weather-now {
        display: grid;
        grid-template-columns: minmax(3em, 6em) auto;
        grid-template-rows: auto auto;
        column-gap: 1em;
        img {
          grid-column: 1/2;
          grid-row: 1/3;
          align-self: center;
        }
        p {
          grid-column: 2/3;
          grid-row: 1/2;
          margin: 0;
          &:nth-of-type(2){
            grid-row: 2/3;
          }
        }
    }
    
    .weather-forecast {
      display: flex;
      background-color: gray;
      column-gap: 0.1rem;
      margin-top: 1rem;
      flex-wrap: wrap;
      .weather-forecast-day {
        background-color: white;
        flex: 1;
        padding: 1em;
        padding-block: 0;
        img {
          aspect-ratio: 1 / 1;
          object-fit: contain;
          object-position: top;
          max-width: 4em;
          min-width: 3em;
        }
      }
    }
  }
</style>